#!/bin/bash

NX=8
NY=8
NZ=28
NX_RAD=2
NY_RAD=2
DX=1000
DT=10
YES3D=1
PLEV=30
INFILE="\'crmdata_nx8_ny8_nz28_nxrad2_nyrad2.nc\'"

rm -rf CMakeCache.txt CMakeFiles cmake_install.cmake cpp CTestTestfile.cmake fortran Makefile

NCFLAGS="`nf-config --flibs` `nc-config --libs`"
echo "NetCDF Flags: $NCFLAGS"

cmake      \
    -DCMAKE_Fortran_FLAGS:STRING=" -O3 -ffree-line-length-none -DCRM -DCRM_NX=$NX -DCRM_NY=$NY -DCRM_NZ=$NZ -DCRM_NX_RAD=$NX_RAD -DCRM_NY_RAD=$NY_RAD -DCRM_DT=$DT -DCRM_DX=$DX -DYES3DVAL=$YES3D -DPLEV=$PLEV -Dsam1mom -DINPUT_FILE=$INFILE -I$NETCDF_PATH/include " \
    -DNCFLAGS:STRING="$NCFLAGS" \
    ..

make clean

make -j32


